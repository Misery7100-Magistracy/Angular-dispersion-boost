\subsubsection{Алгоритм нахождения оптимальных параметров}

Таким образом, мы имеем алгоритм нахождения оптимальных параметров для рассеяния в заданном направлении. 

В первую очередь необходимо оценить радиус кластеров $a$ при помощи аналитической модели (\autoref{m2_resonance}). Полученное значение будет начальной оценкой резонансного значения радиуса кластера при заранее известном материале. 

Далее необходимо выбрать расстояние между кластерами $d$. Задавая большие $d$ для решетки (кратные длине волны падающего поля в случае монохроматического излучения или длине волны наиболее интенсивной спектральной составляющей в случае волнового пакета), мы увеличиваем количество реализуемых дифракционных максимумов, снижая эффективность (отношение диаметра кластера к расстоянию между кластерами уменьшается), но при этом увеличивая диапазон углов, куда можно потенциально отклонить излучение. Малые $d$ обеспечивают наиболее интенсивное рассеяние в ближние порядки дифракции, но имеет ограниченный набор углов, расположенный вблизи пересечений кривых целочисленных решений системы уравнений Лауэ, как это хорошо видно на \autoref{theta0_dphi:b}. 

Описанная теория дифракции (\autoref{bragg_wolf_order_spherical}) позволяет оценить положение таких пересечений и подобрать наиболее подходящее значение $d$ в зависимости от необходимого угла отклонения $\Delta \varphi$, $\Delta \theta$.

После этого, необходимо вычислить рассеянное поле, при помощи которого посчитать интегральную характеристику $E_{\textrm{int}}$ (\autoref{e_int}) для заданной геометрии и диапазона радиуса кластеров $a\pm20\%$ с целью уточнить первоначальную оценку, учесть эффекты дифракции в ближней и средней зоне.

Наличие нерегулярности $\eta$ в решетке неизбежно заставляет дифракционные максимумы расплываться и ослабляться, что необходимо учесть при оценке эффективности рассеяния при помощи \autoref{e_ppart}.